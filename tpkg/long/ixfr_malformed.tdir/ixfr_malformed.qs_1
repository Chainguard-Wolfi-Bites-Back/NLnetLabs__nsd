#!
# premade query answers

$ORIGIN example.com.
$TTL 3600

# reply to question IXFR=1. -> go to TCP
ENTRY_BEGIN
MATCH opcode qtype qname serial=1 UDP
REPLY QUERY NOERROR TC
ADJUST copy_id
SECTION QUESTION
@ IN IXFR
SECTION ANSWER
@ 345600 IN SOA ns0.example.org. root 2 3600 28800 2419200 3600
ENTRY_END

# This is the malformed reply in hexadecimal.
ENTRY_BEGIN
MATCH opcode qtype qname serial=1 TCP
REPLY QUERY NOERROR
ADJUST copy_id
SECTION QUESTION
@ IN IXFR
HEX_ANSWER_BEGIN
; 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19
;-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
 eb 99 00 00 00 01 00 0c 00 00 00 00 07 65 78 61 6d 70 6c 65	;	   1-  20
 03 63 6f 6d 00 00 fb 00 01 07 65 78 61 6d 70 6c 65 03 63 6f	;	  21-  40
 6d 00 00 06 00 01 00 05 46 00 00 37 03 6e 73 30 07 65 78 61	;	  41-  60
 6d 70 6c 65 03 6f 72 67 00 04 72 6f 6f 74 07 65 78 61 6d 70	;	  61-  80
 6c 65 03 63 6f 6d 00 00 00 00 02 00 00 0e 10 00 00 70 80 00	;	  81- 100
 24 ea 00 00 00 0e 10 07 65 78 61 6d 70 6c 65 03 63 6f 6d 00	;	 101- 120
 00 06 00 01 00 05 46 00 00 37 03 6e 73 30 07 65 78 61 6d 70	;	 121- 140
 6c 65 03 6f 72 67 00 04 72 6f 6f 74 07 65 78 61 6d 70 6c 65	;	 141- 160
 03 63 6f 6d 00 00 00 00 01 00 00 0e 10 00 00 70 80 00 24 ea	;	 161- 180
 00 00 00 0e 10 04 74 78 74 34 07 65 78 61 6d 70 6c 65 03 63	;	 181- 200
 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d 74 65 78 74 20 72	;	 201- 220
 65 63 6f 72 64 20 34 04 74 78 74 35 07 65 78 61 6d 70 6c 65	;	 221- 240
 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d 74 65 78 74	;	 241- 260
 20 72 65 63 6f 72 64 20 35 04 74 78 74 36 07 65 78 61 6d 70	;	 261- 280
 6c 65 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d 74 65	;	 281- 300
 78 74 20 72 65 63 6f 72 64 20 36 07 65 78 61 6d 70 6c 65 03	;	 301- 320
 63 6f 6d 00 00 06 00 01 00 05 46 00 00 37 03 6e 73 30 07 65	;	 321- 340
 78 61 6d 70 6c 65 03 6f 72 67 00 04 72 6f 6f 74 07 65 78 61	;	 341- 360
 6d 70 6c 65 03 63 6f 6d 00 00 00 00 02 00 00 0e 10 00 00 70	;	 361- 380
 80 00 24 ea 00 00 00 0e 10 07 65 78 61 6d 70 6c 65 03 63 6f	;	 381- 400
 6d 00 00 02 00 01 00 05 46 00 00 11 03 6e 73 30 07 65 78 61	;	 401- 420
 6d 70 6c 65 03 6f 72 67 00 07 65 78 61 6d 70 6c 65 03 63 6f	;	 421- 440
 6d 00 00 02 00 01 00 05 46 00 00 11 ff 6e 73 31 07 65 78 61	;	 441- 460
 6d 70 6c 65 03 6f 72 67 00 04 74 78 74 31 07 65 78 61 6d 70	;	 461- 480
 6c 65 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d 74 65	;	 481- 500
 78 74 20 72 65 63 6f 72 64 20 31 04 74 78 74 32 07 65 78 61	;	 501- 520
 6d 70 6c 65 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d	;	 521- 540
 74 65 78 74 20 72 65 63 6f 72 64 20 32 04 74 78 74 33 07 65	;	 541- 560
 78 61 6d 70 6c 65 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00	;	 561- 580
 0e 0d 74 65 78 74 20 72 65 63 6f 72 64 20 33 07 65 78 61 6d	;	 581- 600
 70 6c 65 03 63 6f 6d 00 00 06 00 01 00 05 46 00 00 37 03 6e	;	 601- 620
 73 30 07 65 78 61 6d 70 6c 65 03 6f 72 67 00 04 72 6f 6f 74	;	 621- 640
 07 65 78 61 6d 70 6c 65 03 63 6f 6d 00 00 00 00 02 00 00 0e	;	 641- 660
 10 00 00 70 80 00 24 ea 00 00 00 0e 10
HEX_ANSWER_END
# line with 'ns1' is garbled, length of dname label is changed to ff.
# 6d 00 00 02 00 01 00 05 46 00 00 11 03 6e 73 31 07 65 78 61	;	 441- 460
# 6d 00 00 02 00 01 00 05 46 00 00 11 ff 6e 73 31 07 65 78 61	;	 441- 460
ENTRY_END


# This is the correct reply in hexadecimal.
ENTRY_BEGIN
MATCH opcode qtype qname serial=1 TCP
REPLY QUERY NOERROR
ADJUST copy_id
SECTION QUESTION
correct!!!.example.com. IN IXFR
HEX_ANSWER_BEGIN
; 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19
;-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
 eb 99 00 00 00 01 00 0c 00 00 00 00 07 65 78 61 6d 70 6c 65	;	   1-  20
 03 63 6f 6d 00 00 fb 00 01 07 65 78 61 6d 70 6c 65 03 63 6f	;	  21-  40
 6d 00 00 06 00 01 00 05 46 00 00 37 03 6e 73 30 07 65 78 61	;	  41-  60
 6d 70 6c 65 03 6f 72 67 00 04 72 6f 6f 74 07 65 78 61 6d 70	;	  61-  80
 6c 65 03 63 6f 6d 00 00 00 00 02 00 00 0e 10 00 00 70 80 00	;	  81- 100
 24 ea 00 00 00 0e 10 07 65 78 61 6d 70 6c 65 03 63 6f 6d 00	;	 101- 120
 00 06 00 01 00 05 46 00 00 37 03 6e 73 30 07 65 78 61 6d 70	;	 121- 140
 6c 65 03 6f 72 67 00 04 72 6f 6f 74 07 65 78 61 6d 70 6c 65	;	 141- 160
 03 63 6f 6d 00 00 00 00 01 00 00 0e 10 00 00 70 80 00 24 ea	;	 161- 180
 00 00 00 0e 10 04 74 78 74 34 07 65 78 61 6d 70 6c 65 03 63	;	 181- 200
 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d 74 65 78 74 20 72	;	 201- 220
 65 63 6f 72 64 20 34 04 74 78 74 35 07 65 78 61 6d 70 6c 65	;	 221- 240
 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d 74 65 78 74	;	 241- 260
 20 72 65 63 6f 72 64 20 35 04 74 78 74 36 07 65 78 61 6d 70	;	 261- 280
 6c 65 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d 74 65	;	 281- 300
 78 74 20 72 65 63 6f 72 64 20 36 07 65 78 61 6d 70 6c 65 03	;	 301- 320
 63 6f 6d 00 00 06 00 01 00 05 46 00 00 37 03 6e 73 30 07 65	;	 321- 340
 78 61 6d 70 6c 65 03 6f 72 67 00 04 72 6f 6f 74 07 65 78 61	;	 341- 360
 6d 70 6c 65 03 63 6f 6d 00 00 00 00 02 00 00 0e 10 00 00 70	;	 361- 380
 80 00 24 ea 00 00 00 0e 10 07 65 78 61 6d 70 6c 65 03 63 6f	;	 381- 400
 6d 00 00 02 00 01 00 05 46 00 00 11 03 6e 73 30 07 65 78 61	;	 401- 420
 6d 70 6c 65 03 6f 72 67 00 07 65 78 61 6d 70 6c 65 03 63 6f	;	 421- 440
 6d 00 00 02 00 01 00 05 46 00 00 11 03 6e 73 31 07 65 78 61	;	 441- 460
 6d 70 6c 65 03 6f 72 67 00 04 74 78 74 31 07 65 78 61 6d 70	;	 461- 480
 6c 65 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d 74 65	;	 481- 500
 78 74 20 72 65 63 6f 72 64 20 31 04 74 78 74 32 07 65 78 61	;	 501- 520
 6d 70 6c 65 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00 0e 0d	;	 521- 540
 74 65 78 74 20 72 65 63 6f 72 64 20 32 04 74 78 74 33 07 65	;	 541- 560
 78 61 6d 70 6c 65 03 63 6f 6d 00 00 10 00 01 00 05 46 00 00	;	 561- 580
 0e 0d 74 65 78 74 20 72 65 63 6f 72 64 20 33 07 65 78 61 6d	;	 581- 600
 70 6c 65 03 63 6f 6d 00 00 06 00 01 00 05 46 00 00 37 03 6e	;	 601- 620
 73 30 07 65 78 61 6d 70 6c 65 03 6f 72 67 00 04 72 6f 6f 74	;	 621- 640
 07 65 78 61 6d 70 6c 65 03 63 6f 6d 00 00 00 00 02 00 00 0e	;	 641- 660
 10 00 00 70 80 00 24 ea 00 00 00 0e 10
HEX_ANSWER_END
ENTRY_END

# below the original reply. The NS dname is malformed.
# reply to TCP for serial=1
#ENTRY_BEGIN
#MATCH opcode qtype qname serial=1 TCP
#REPLY QUERY NOERROR
#ADJUST copy_id
#SECTION QUESTION
#@ IN IXFR
#SECTION ANSWER
#@ 345600 IN SOA ns0.example.org. root 2 3600 28800 2419200 3600
#@ 345600 IN SOA ns0.example.org. root 1 3600 28800 2419200 3600
#txt4    345600  IN      TXT     "text record 4"
#txt5    345600  IN      TXT     "text record 5"
#txt6    345600  IN      TXT     "text record 6"
#@ 345600 IN SOA ns0.example.org. root 2 3600 28800 2419200 3600
#@	345600  IN      NS      ns0.example.org.
#@	345600  IN      NS      ns1.example.org.
#txt1    345600  IN      TXT     "text record 1"
#txt2    345600  IN      TXT     "text record 2"
#txt3    345600  IN      TXT     "text record 3"
#@ 345600 IN SOA ns0.example.org. root 2 3600 28800 2419200 3600
#ENTRY_END
